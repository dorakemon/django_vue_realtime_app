(function(e){function t(t){for(var s,r,i=t[0],u=t[1],c=t[2],d=0,m=[];d<i.length;d++)r=i[d],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&m.push(a[r][0]),a[r]=0;for(s in u)Object.prototype.hasOwnProperty.call(u,s)&&(e[s]=u[s]);l&&l(t);while(m.length)m.shift()();return o.push.apply(o,c||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],s=!0,i=1;i<n.length;i++){var u=n[i];0!==a[u]&&(s=!1)}s&&(o.splice(t--,1),e=r(r.s=n[0]))}return e}var s={},a={app:0},o=[];function r(t){if(s[t])return s[t].exports;var n=s[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=s,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(n,s,function(t){return e[t]}.bind(null,s));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],u=i.push.bind(i);i.push=t,i=i.slice();for(var c=0;c<i.length;c++)t(i[c]);var l=u;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},1:function(e,t){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var s=n("2b0e"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("div",{staticClass:"container"},[n("div",{staticClass:"row"},[n("div",{staticClass:"col-md-6 offset-md-3"},[n("router-view")],1)])])])},o=[],r={name:"app",components:{}},i=r,u=n("2877"),c=Object(u["a"])(i,a,o,!1,null,null,null),l=c.exports,d=(n("45fc"),n("8c4f")),m=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home"},[n("Chat")],1)},p=[],f=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"card mt-3"},[n("div",{staticClass:"card-body"},[e._m(0),n("div",{staticClass:"card-body"},[e._l(e.test,(function(t,s){return n("div",{key:s,staticClass:"test"},[n("p",[n("span",{staticClass:"font-weight-bold"},[e._v(e._s(t.username)+": ")]),e._v(e._s(t.content))])])})),e._l(e.messages,(function(t,s){return n("div",{key:s,staticClass:"messages"},[n("p",[n("span",{staticClass:"font-weight-bold"},[e._v(e._s(t.user)+": ")]),e._v(e._s(t.message))])])}))],2)]),n("div",{staticClass:"card-footer"},[n("form",{on:{submit:function(t){return t.preventDefault(),e.sendMessage(t)}}},[n("div",{staticClass:"gorm-group"},[n("label",{attrs:{for:"user"}},[e._v("User:")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.user,expression:"user"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:e.user},on:{input:function(t){t.target.composing||(e.user=t.target.value)}}})]),n("div",{staticClass:"gorm-group pb-3"},[n("label",{attrs:{for:"message"}},[e._v("Message:")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.message,expression:"message"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:e.message},on:{input:function(t){t.target.composing||(e.message=t.target.value)}}})]),n("button",{staticClass:"btn btn-success",attrs:{type:"submit"}},[e._v("Send")])])])])},g=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"card-title"},[n("h3",[e._v("Todo Group")]),n("hr")])}],v=(n("99af"),n("fb6a"),n("2909")),h=n("8055"),b=n.n(h),_=n("bc3a"),w=n.n(_),y={name:"Chat",data:function(){return{user:"",message:"",messages:[],socket:b()("localhost:3001"),test:""}},methods:{sendMessage:function(e){e.preventDefault(),this.socket.emit("SEND_MESSAGE",{user:this.user,message:this.message}),this.message=""}},mounted:function(){var e=this;this.socket.on("MESSAGE",(function(t){e.messages=[].concat(Object(v["a"])(e.messages),[t])})),w.a.get("http://localhost:8000/api/todo/",{headers:{"Content-Type":"application/json",Authorization:"JWT ".concat(localStorage.getItem("jwt").slice(1).slice(0,-1))},data:{}}).then((function(t){e.test=t.data}))}},C=y,j=Object(u["a"])(C,f,g,!1,null,null,null),x=j.exports,S={name:"Home",components:{Chat:x}},O=S,T=Object(u["a"])(O,m,p,!1,null,null,null),k=T.exports,I=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},E=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"about"},[n("h1",[e._v("This is an about page")])])}],P={},M=Object(u["a"])(P,I,E,!1,null,null,null),$=M.exports,A=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h2",[e._v("ログイン")]),n("form",{on:{submit:function(t){return t.preventDefault(),e.login(t)}}},[n("div",{staticClass:"username"},[n("label",{attrs:{for:"username"}},[e._v("ユーザーネーム")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:e.username},on:{input:function(t){t.target.composing||(e.username=t.target.value)}}})]),n("div",{staticClass:"password pb-3"},[n("label",{attrs:{for:"password"}},[e._v("パスワード")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"form-control",attrs:{type:"password"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}})]),n("button",{staticClass:"btn btn-success",attrs:{type:"submit"}},[e._v("ログイン")])])])},N=[],J={name:"Login",data:function(){return{username:"",password:""}},methods:{login:function(){this.$store.dispatch("login",{username:this.username,password:this.password})}}},L=J,D=Object(u["a"])(L,A,N,!1,null,"659eb78c",null),q=D.exports,G=n("2f62"),U=w.a.create({baseURL:"http://localhost:8000/api/auth/"}),z=U;s["a"].use(G["a"]);var H=new G["a"].Store({state:{idToken:"",loggedIn:!1,username:""},getters:{idToken:function(e){return e.idToken},loggedIn:function(e){return e.loggedIn},username:function(e){return e.username}},mutations:{storeIdToken:function(e,t){e.idToken=t,localStorage.setItem("jwt",JSON.stringify(t)),e.loggedIn=!0},clear:function(e){e.idToken="",e.idLoggedIn=!1},set:function(e,t){e.username=t.user.username,e.isLoggedIn=!0}},actions:{login:function(e,t){var n=e.commit;z.post("jwt/create/",{username:t.username,password:t.password}).then((function(e){n("storeIdToken",e.data.access),F.push("/")}))},logout:function(e){var t=e.commit;localStorage.removeItem("jwt"),t("clear")},reload:function(e){var t=e.commit;return z.get("users/me/",{headers:{"Content-Type":"application/json",Authorization:"JWT ".concat(localStorage.getItem("jwt").slice(1).slice(0,-1))},data:{}}).then((function(e){var n=e.data;return t("set",{user:n}),n}))}}});s["a"].use(d["a"]);var W=[{path:"/",name:"Home",component:k,meta:{requiresAuth:!0}},{path:"/about/",name:"About",component:$},{path:"/login/",name:"Login",component:q},{path:"*",redirect:"/"}],R=new d["a"]({mode:"history",base:"/",routes:W});function B(e,t,n){n({path:"/login",query:{next:e.fullPath}})}R.beforeEach((function(e,t,n){var s=H.getters.loggedIn,a=localStorage.getItem("jwt");e.matched.some((function(e){return e.meta.requiresAuth}))?s?n():null!=a?(console.log("User is not logged in. Trying to reload again."),H.dispatch("reload").then((function(){console.log("Succeeded to reload. So, free to next."),n()})).catch((function(){B(e,t,n)}))):B(e,t,n):n()}));var F=R;s["a"].config.productionTip=!1,new s["a"]({router:F,store:H,render:function(e){return e(l)}}).$mount("#app")}});
//# sourceMappingURL=app.73a279e9.js.map